select
  id as userid,
  (id = ?3) as ItIsMe,
  nick as username,
  av_time as AVer,
  status,
  user_desc,
  case when (Lang is NULL) then 0 else Lang+1 end as Lang,
  skin,
  strftime('%d.%m.%Y %H:%M:%S', LastSeen, 'unixepoch') as LastSeen,
  email,
  (select count() from posts p left join LimitedAccessThreads lt on lt.threadid = p.threadid where p.userid = u.id and (lt.userid is null or lt.userid = ?3)) as totalposts,
  ?2 as Ticket,

  case when (status & 0x00000001) then 'checked' end user_perm0,
  case when (status & 0x00000002) then 'checked' end user_perm1,
  case when (status & 0x00000004) then 'checked' end user_perm2,
  case when (status & 0x00000008) then 'checked' end user_perm3,
  case when (status & 0x00000010) then 'checked' end user_perm4,
  case when (status & 0x00000020) then 'checked' end user_perm5,
  case when (status & 0x00000040) then 'checked' end user_perm6,
  case when (status & 0x00000080) then 'checked' end user_perm7,
  case when (status & 0x00000100) then 'checked' end user_perm8,
  case when (status & 0x00000200) then 'checked' end user_perm9,
  case when (status & 0x00000400) then 'checked' end user_perm10,
  case when (status & 0x00000800) then 'checked' end user_perm11,
  case when (status & 0x00001000) then 'checked' end user_perm12,
  case when (status & 0x00002000) then 'checked' end user_perm13,
  case when (status & 0x00004000) then 'checked' end user_perm14,
  case when (status & 0x00008000) then 'checked' end user_perm15,
  case when (status & 0x00010000) then 'checked' end user_perm16,
  case when (status & 0x00020000) then 'checked' end user_perm17,
  case when (status & 0x00040000) then 'checked' end user_perm18,
  case when (status & 0x00080000) then 'checked' end user_perm19,
  case when (status & 0x00100000) then 'checked' end user_perm20,
  case when (status & 0x00200000) then 'checked' end user_perm21,
  case when (status & 0x00400000) then 'checked' end user_perm22,
  case when (status & 0x00800000) then 'checked' end user_perm23,
  case when (status & 0x01000000) then 'checked' end user_perm24,
  case when (status & 0x02000000) then 'checked' end user_perm25,
  case when (status & 0x04000000) then 'checked' end user_perm26,
  case when (status & 0x08000000) then 'checked' end user_perm27,
  case when (status & 0x10000000) then 'checked' end user_perm28,
  case when (status & 0x20000000) then 'checked' end user_perm29,
  case when (status & 0x40000000) then 'checked' end user_perm30,
  case when (status & 0x80000000) then 'checked' end user_perm31,

  PostInterval,
  PostIntervalInc,
  MaxPostLen

from users u
where nick = ?1
